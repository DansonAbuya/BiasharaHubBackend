<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
    xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
        https://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.20.xsd">

    <changeSet id="001-create-tenants-table" author="biasharahub">
        <comment>Create tenants registry table in public schema</comment>
        <sql>
            CREATE TABLE IF NOT EXISTS public.tenants (
                tenant_id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
                schema_name VARCHAR(63) NOT NULL UNIQUE,
                name VARCHAR(255) NOT NULL,
                domain VARCHAR(255),
                logo_url VARCHAR(500),
                primary_color VARCHAR(7) DEFAULT '#2E7D32',
                accent_color VARCHAR(7) DEFAULT '#FF8F00',
                is_active BOOLEAN DEFAULT true,
                created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
                updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP
            );
            CREATE INDEX IF NOT EXISTS idx_tenants_schema_name ON public.tenants(schema_name);
            CREATE INDEX IF NOT EXISTS idx_tenants_domain ON public.tenants(domain);
            CREATE INDEX IF NOT EXISTS idx_tenants_is_active ON public.tenants(is_active);
            COMMENT ON TABLE public.tenants IS 'Multi-tenant registry. Each tenant has isolated data in a dedicated schema.';
        </sql>
    </changeSet>

</databaseChangeLog>
