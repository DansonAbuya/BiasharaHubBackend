# ======================
# Spring Boot App
# ======================
spring.application.name=biasharahub-backend

# ======================
# Server
# ======================
server.port=${PORT:5050}
server.servlet.context-path=/api
server.ssl.enabled=false

# ======================
# PostgreSQL Datasource
# ======================
spring.datasource.url=${SPRING_DATASOURCE_URL:${DB_URL:jdbc:postgresql://localhost:5432/biasharahub}}
spring.datasource.username=${SPRING_DATASOURCE_USERNAME:${DB_USERNAME:postgres}}
spring.datasource.password=${SPRING_DATASOURCE_PASSWORD:${DB_PASSWORD:password}}
spring.datasource.driver-class-name=org.postgresql.Driver
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=5

# ======================
# JPA / Hibernate
# ======================
spring.jpa.hibernate.ddl-auto=validate
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.properties.hibernate.default_schema=${tenant.schema:tenant_default}
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.open-in-view=false

# ======================
# Liquibase
# ======================
spring.liquibase.change-log=classpath:db/changelog/db.changelog-master.xml
spring.liquibase.liquibase-schema=public
spring.liquibase.default-schema=public

# ======================
# Redis
# ======================
spring.cache.type=redis
spring.cache.redis.time-to-live=300000
spring.data.redis.host=${SPRING_DATA_REDIS_HOST:${REDIS_HOST:localhost}}
spring.data.redis.port=${SPRING_DATA_REDIS_PORT:${REDIS_PORT:6379}}
spring.data.redis.repositories.enabled=false
spring.data.redis.password=${REDIS_PASSWORD:}

# ======================
# Mail (SMTP)
# ======================
spring.mail.host=${MAIL_HOST:localhost}
spring.mail.port=${MAIL_PORT:1025}
spring.mail.username=${MAIL_USERNAME:}
spring.mail.password=${MAIL_PASSWORD:}
spring.mail.properties.mail.smtp.auth=${MAIL_SMTP_AUTH:false}
spring.mail.properties.mail.smtp.starttls.enable=${MAIL_SMTP_STARTTLS_ENABLE:false}

# ======================
# JWT
# ======================
jwt.secret=${JWT_SECRET:biasharahub-super-secret-key-min-256-bits-required-for-hs256}
jwt.expiration-ms=3600000
jwt.refresh-expiration-ms=604800000

# ======================
# Frontend / OAuth2
# ======================
app.frontend-url=${APP_FRONTEND_URL:http://localhost:3000}
app.oauth2.backend-base-url=${OAUTH2_BACKEND_BASE_URL:http://localhost:5050/api}
app.oauth2.frontend-redirect-uri=${OAUTH2_FRONTEND_REDIRECT_URI:http://localhost:3000/auth/callback}

# ======================
# Postmark / Gmail
# ======================
app.mail.from=${MAIL_FROM:}
app.postmark.server-token=${POSTMARK_SERVER_TOKEN:}
app.postmark.from=${MAIL_FROM:}
app.postmark.message-stream=${POSTMARK_MESSAGE_STREAM:outbound}
app.gmail.client-id=${GMAIL_CLIENT_ID:}
app.gmail.client-secret=${GMAIL_CLIENT_SECRET:}
app.gmail.refresh-token=${GMAIL_REFRESH_TOKEN:}
app.gmail.from=${MAIL_FROM:}
app.gmail.refresh-interval-ms=3000000

# ======================
# CORS
# ======================
app.cors.allowed-origins=${APP_CORS_ALLOWED_ORIGINS:http://localhost:3000,http://127.0.0.1:3000}

# ======================
# Kafka
# ======================
app.kafka.enabled=${KAFKA_ENABLED:false}
app.kafka.bootstrap-servers=${KAFKA_BOOTSTRAP_SERVERS:localhost:9092}
app.kafka.producer.key-serializer=org.apache.kafka.common.serialization.StringSerializer
app.kafka.producer.value-serializer=org.springframework.kafka.support.serializer.JsonSerializer
app.kafka.consumer.group-id=${KAFKA_CONSUMER_GROUP:biasharahub}
app.kafka.consumer.auto-offset-reset=earliest
app.kafka.consumer.key-deserializer=org.apache.kafka.common.serialization.StringDeserializer
app.kafka.consumer.value-deserializer=org.springframework.kafka.support.serializer.JsonDeserializer
app.kafka.consumer.properties.spring.json.trusted.packages=com.biasharahub.messaging
app.kafka.listener.missing-topics-fatal=false
app.kafka.topics.order-created=${KAFKA_TOPIC_ORDER_CREATED:orders.created}
app.kafka.topics.payment-completed=${KAFKA_TOPIC_PAYMENT_COMPLETED:payments.completed}

# ======================
# Messaging
# ======================
app.messaging.in-process.enabled=${MESSAGING_IN_PROCESS_ENABLED:true}

# ======================
# Wallet
# ======================
app.wallet.platform-commission-rate=${PLATFORM_COMMISSION_RATE:0.1}
app.wallet.min-payout-kes=${WALLET_MIN_PAYOUT_KES:10}

# ======================
# M-Pesa (Daraja)
# ======================
app.mpesa.enabled=${MPESA_ENABLED:false}
app.mpesa.environment=${MPESA_ENV:sandbox}
app.mpesa.base-url=${MPESA_BASE_URL:https://sandbox.safaricom.co.ke}
app.mpesa.shortcode=${MPESA_SHORTCODE:174379}
app.mpesa.passkey=${MPESA_PASSKEY:}
app.mpesa.consumer-key=${MPESA_CONSUMER_KEY:}
app.mpesa.consumer-secret=${MPESA_CONSUMER_SECRET:}
app.mpesa.stk-callback-url=${MPESA_STK_CALLBACK_URL:}
app.mpesa.b2c-callback-url=${MPESA_B2C_CALLBACK_URL:}
app.mpesa.payout-product-name=${MPESA_PAYOUT_PRODUCT_NAME:testapi}
app.mpesa.b2c-initiator-name=${MPESA_B2C_INITIATOR_NAME:}
app.mpesa.b2c-security-credential=${MPESA_B2C_SECURITY_CREDENTIAL:}
app.mpesa.b2c-shortcode=${MPESA_B2C_SHORTCODE:${MPESA_SHORTCODE:174379}}
app.mpesa.timeout=${MPESA_TIMEOUT_MS:10000}

# ======================
# Twilio / WhatsApp
# ======================
app.whatsapp.enabled=${WHATSAPP_ENABLED:false}
app.whatsapp.twilio-account-sid=${TWILIO_ACCOUNT_SID:}
app.whatsapp.twilio-auth-token=${TWILIO_AUTH_TOKEN:}
app.whatsapp.from-number=${TWILIO_WHATSAPP_FROM:whatsapp:+14155238886}
app.whatsapp.webhook-url=${WHATSAPP_WEBHOOK_URL:}

# ======================
# Storefront
# ======================
app.storefront-url=${STOREFRONT_URL:http://localhost:3000}

# ======================
# Courier
# ======================
app.courier.api-keys.dhl=${COURIER_DHL_API_KEY:}
app.courier.api-keys.fedex=${COURIER_FEDEX_API_KEY:}
app.courier.api-keys.sendy=${COURIER_SENDY_API_KEY:}

# ======================
# Cloudflare R2
# ======================
r2.enabled=${R2_ENABLED:false}
r2.bucket=${R2_BUCKET:biasharahub-product-images}
r2.endpoint=${R2_ENDPOINT:https://03c04814dd2c76d33ab9692b1255838c.r2.cloudflarestorage.com}
r2.access-key-id=${R2_ACCESS_KEY_ID:}
r2.secret-access-key=${R2_SECRET_ACCESS_KEY:}
r2.public-url=${R2_PUBLIC_URL:}

# ======================
# Encryption
# ======================
encryption.secret=${ENCRYPTION_SECRET:please-change-me-32-bytes-min}
